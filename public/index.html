<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gabriel Mosci - Proyecto Integrador</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="icon" href="img/logo.png">
    <script defer src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>    
    <script defer src="js/vendors/paginate.js"></script>
    <script defer src="js/Card.js"></script>
    <script defer src="js/main.js" type="module"></script>
</head>

<body>
    <!-- Botón flotante Whatsapp -->
    <a href="https://wa.me/543515555555" class="whatsapp-btn" target="_blank"></a>

    <!-- Ventana de errores validación inputs -->
    <div class="general-errors ok">
        <img src="img/advertencia.png" alt="Aviso">
    </div>
    
    <!-- Confirmación de Eliminación de producto -->
    <div class="main-header__delete-modalbox">
        <div class="delete-product in">
            <img src="img/advertencia.png" alt="Aviso">
            ¿Confirma la ELIMINACION definitiva de este producto?
            <div class="delete-product__buttons">
                <button id="buttonYes" class="btn-submit btn-submit-yes" title="Confirmar eliminación">Si</button>
                <button id="buttonNo" class="btn-submit btn-submit-no" title="Cancelar eliminación">No</button>
            </div>
        </div>
    </div>
    <!-- Aviso de pago procesado -->
    <div class="main-header__pay-confirmed-modalbox">
        <div class="pay-confirmed show">
            <button class="main-header__cart-content-button-close" title="Cerrar"></button>
            <h2>El pago ha sido procesado con éxito.</h2>
            <p>Nota: este es un sistema con fines didácticos, NO se utilizó el método POST</p>
            <p>para enviar los datos a la plataforma de pagos.</p>
        </div>
    </div>
    <!-- Activación Burger Button -->
    <input type="checkbox" class="main-nav-toggle" id="main-nav-toggle">
    
    <!-- ================================ Main Header ================================ -->
    <header class="main-header">

        <!-- Logo -->
        <div class="main-header__logo-container">
            <img src="img/logo.png" alt="Juguetería Cósmica">
        </div>
        
        <!-- Search Form -->
        <div class="main-header__search-form-container">
            <label for="searchSite"></label>
            <input type="search" id="searchSite" placeholder="Buscar...">
            <button class="main-header__search-form-container-button" type="submit"></button>
        </div>
        
        <!--==== Cart ====-->
        <!-- cart button -->
        <div class="main-header__cart-button-container">
            <span class="main-header__cart-button-container-qty" id="cart-qty"></span>
            <img src="img/i-carrito.png" alt="Carrito">
        </div>
        <!-- cart content -->
        <div class="main-header__cart-modalbox">
            <div class="main-header__cart-content">
                <button class="main-header__cart-content-button-close" title="Cerrar"></button>
                <div class="main-header__cart-content-title"><h4 id="cart-title">Productos en tu carrito</h4></div>

<!--  
                <div class="main-header__cart-content-products">
                    <button class="main-header__cart-content-products-delete" title="Eliminar"></button>
                    <div class="main-header__cart-content-products-image">
                        <img id="product-image" src="img/j-muneca.jpg" alt="Muñeca llorona">
                    </div>
                    <div class="main-header__cart-content-products-description">
                        <p id="product-description">Muñeca llorona</p>
                    </div>
                    <div class="main-header__cart-content-products-price">
                        <p id="product-price">$17099</p>
                    </div>
                    <div class="main-header__cart-content-products-quantity">
                        x<input id="product-quantity" type="number" min="1" max="99" value="1">
                    </div>
                    <div class="main-header__cart-content-products-subtotal">
                        <p id="product-subtotal">= $17099</p>
                    </div>
                </div>

                <div id="main-header__cart-content-footer" class="main-header__cart-content-footer">
                    <div class="main-header__cart-content-footer-total">Total: 10</div>
                    <div><button class="main-header__cart-content-btn-buy btn btn-primary btn-lg btn-block" id="checkout-btn">Confirmar compra</button></div>
                </div>
-->

            </div>
        </div>
        <!-- Burger Button -->
        <div class="main-header__hamburger-button-container">
            <label class="hamburger-button" for="main-nav-toggle" title="Alternar la barra de navegación">
                <span class="hamburger-button__top-bread"></span>
                <span class="hamburger-button__meat"></span>
                <span class="hamburger-button__bottom-bread"></span>
            </label>
        </div>
        
        <!-- Main Nav -->
        <div class="main-header__main-nav-container">
            <nav class="main-nav">
                <ul class="main-nav__list">
                    <li class="main-nav__item">
                        <a href="#/inicio" class="main-nav__link">Inicio</a>
                    </li>
                    <li class="main-nav__item">
                        <a href="#/alta" class="main-nav__link">Alta</a>
                    </li>
                    <li class="main-nav__item">
                        <a href="#/contacto" class="main-nav__link">Contacto</a>
                    </li>
                    <li class="main-nav__item">
                        <a href="#/nosotros" class="main-nav__link">Nosotros</a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    
    <!-- ================================ Contenido ================================ -->
    <main></main>

    <!-- ================================= Footer ================================== -->
    <footer class="main-footer">
        <p>Seguinos en todas nuestras redes sociales:</p>
        <div class="main-footer__social">
            <a href="https://www.instagram.com/" target="_blank"><img src="img/r-instagram.png" alt="instagram" title="instagram"></a>
            <a href="https://www.twitter.com/" target="_blank"><img src="img/r-twitter.png" alt="twitter" title="twitter"></a>
            <a href="https://www.facebook.com/" target="_blank"><img src="img/r-facebook.png" alt="facebook" title="facebook"></a>
            <a href="https://www.youtube.com/" target="_blank"><img src="img/r-youtube.png" alt="youtube" title="youtube"></a>
        </div>
        <p>© 2022 Juguetería Cósmica. 📩 Av. Colon 25 - Córdoba - 5000. 📞 (0351) 555-5555. Todos los derechos reservados.</p>
    </footer>

    <div class="spin-modalbox">
        <img src="./img/wait-spin.webp" alt="cargando...">
    </div>    
    
    <!-- 
    <div id="cardPaymentBrick_container-modalbox">
        <div id="cardPaymentBrick_container"></div>
    </div>
-->

</body>
</html>

<!-- -----------------------------------------------------------------
-                           Mercado Pago                             -
------------------------------------------------------------------ -->

<script src="https://sdk.mercadopago.com/js/v2"></script>


<script>
    const mercadopago = new MercadoPago('TEST-b0f084c6-dd31-43a9-b60d-6ad662efbe28', {
        locale: 'es-AR' // The most common are: 'pt-BR', 'es-AR' and 'en-US'
    });
    
</script>
<!--  
<script>
    var mpEnviado = 0;

    const mp = new MercadoPago('TEST-b0f084c6-dd31-43a9-b60d-6ad662efbe28');
    const bricksBuilder = mp.bricks();

    const renderCardPaymentBrick = async (bricksBuilder) => {

        const settings = {
            initialization: {
            amount: 100, //value of the payment to be processed

            },
            customization: {
                visual: {
                    style: {
                        theme: 'default' // 'default' |'dark' | 'bootstrap' | 'flat'
                    } 
                }
            },
            callbacks: {
                onSubmit: (cardFormData) => {
                    try {
                        // CANCELADA FUNCION DE PAGO ****DESARROLLAR****
                        // mpEnviado = 3;
                        // setTimeout(() => {
                        //     document.querySelector('#cardPaymentBrick_container').classList.add('out');
                        //     setTimeout(() => {
                        //         document.querySelector('#cardPaymentBrick_container').classList.remove('out');
                        //         document.querySelector('#cardPaymentBrick_container-modalbox').style.display = 'none';
                        //     },390);

                        // },2500);

                        return new Promise((resolve, reject) => {
                            fetch("/process_payment", { 
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify(cardFormData)
                            })
                            .then((response) => {
                                // get payment result
                                resolve();
                            })
                            .catch((error) => {
                                // get payment result error
                                reject();
                            })
                        });
                    } catch (error){
                        console.error('ERROR POST', error);
                    }
                },

                onReady: () => {
                    // handle form ready
                },
                onError: (error) => {
                    alert('error');
                }
            }                       
        }

        cardPaymentBrickController = await bricksBuilder.create('cardPayment', 'cardPaymentBrick_container', settings);
    };

    renderCardPaymentBrick(bricksBuilder);
</script>
-->